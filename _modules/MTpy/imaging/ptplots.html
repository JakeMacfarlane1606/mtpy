

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>MTpy.imaging.ptplots &mdash; MTpy 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="MTpy 0.1 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">MTpy 0.1 documentation</a> &raquo;</li>
          <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for MTpy.imaging.ptplots</h1><div class="highlight"><pre>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Mon Jul 19 17:27:06 2010</span>

<span class="sd">Author: Jared Peacock</span>

<span class="sd">Based on MTAnalysis.m and LoadEDI.m written by Stephan Thiel </span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">MTpy.core.Z</span> <span class="kn">import</span> <span class="n">Z</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">FormatStrFormatter</span><span class="p">,</span><span class="n">MultipleLocator</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Ellipse</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LinearSegmentedColormap</span><span class="p">,</span><span class="n">Normalize</span>
<span class="kn">from</span> <span class="nn">matplotlib.colorbar</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c">#make a custom colormap to use for plotting</span>
<span class="n">ptcmapdict</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;red&#39;</span><span class="p">:((</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)),</span>
            <span class="s">&#39;green&#39;</span><span class="p">:((</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)),</span>
            <span class="s">&#39;blue&#39;</span><span class="p">:((</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">),(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">))}</span>
<span class="n">ptcmap</span><span class="o">=</span><span class="n">LinearSegmentedColormap</span><span class="p">(</span><span class="s">&#39;ptcmap&#39;</span><span class="p">,</span><span class="n">ptcmapdict</span><span class="p">,</span><span class="mi">256</span><span class="p">)</span>

<div class="viewcode-block" id="ptplots"><a class="viewcode-back" href="../../../imaging.ptplots.html#MTpy.imaging.ptplots.ptplots">[docs]</a><span class="k">class</span> <span class="nc">ptplots</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ptplots will plot different parameters of the phase tensor and invariants</span>
<span class="sd">    given a list of plot types for an input of impvar which can be an .imp file,</span>
<span class="sd">    .edi file or a dictionary with keys:</span>
<span class="sd">     impvar[&#39;station&#39;] -&gt; station name </span>
<span class="sd">     impvar[&#39;lat&#39;] -&gt; latitude in deg </span>
<span class="sd">     impvar[&#39;lon&#39;] -&gt; longitude in deg </span>
<span class="sd">     impvar[&#39;periodlst&#39;] -&gt; period list </span>
<span class="sd">     impvar[&#39;zlst&#39;] -&gt; impedance tensor list at [[zxx,zxy],[zyx,zyy]]</span>
<span class="sd">     impvar[&#39;zvar&#39;] -&gt; impedance tensor variance same fmt as z</span>
<span class="sd">     impvar[&#39;tip&#39;] -&gt; tipper array as [txx,txy]</span>
<span class="sd">     impvar[&#39;tipvar&#39;] -&gt; tipper variance as [txxvar,tyyvar]</span>
<span class="sd">    </span>
<span class="sd">    Plots are: </span>
<span class="sd">    </span>
<span class="sd">     plotPhaseTensor(save=&#39;n&#39;,fmt=&#39;pdf&#39;,fignum=1,thetar=0) -&gt; plots the phase tensor as </span>
<span class="sd">     ellipses with long axis directed towards electrical strike and short axis</span>
<span class="sd">     directed across magnetic strike.  Spaces the ellipses across the period axis.</span>
<span class="sd">    </span>
<span class="sd">     plotStrikeAngle(save=&#39;n&#39;,fmt=&#39;pdf&#39;,fignum=1,thetar=0) -&gt; plots the electric </span>
<span class="sd">     strike angle as a function of period with error bars. </span>
<span class="sd">    </span>
<span class="sd">     plotMinMaxPhase(save=&#39;n&#39;,fmt=&#39;pdf&#39;,fignum=1,thetar=0) -&gt; plots the min and max </span>
<span class="sd">     phase angle as a function of period with error bars.  </span>
<span class="sd">    </span>
<span class="sd">     plotAzimuth(save=&#39;n&#39;,fmt=&#39;pdf&#39;,fignum=1,thetar=0) -&gt; plots the azimuth angle as</span>
<span class="sd">     a function of period with error bars. </span>
<span class="sd">    </span>
<span class="sd">     plotSkew(save=&#39;n&#39;,fmt=&#39;pdf&#39;,fignum=1,thetar=0) -&gt; plots the skew angle as a </span>
<span class="sd">     function of period with error bars.  </span>
<span class="sd">    </span>
<span class="sd">     plotElliticity(save=&#39;n&#39;,fmt=&#39;pdf&#39;,fignum=1,thetar=0) -&gt; plots the ellipticity </span>
<span class="sd">     as a function of period with error bars. </span>
<span class="sd">    </span>
<span class="sd">     plotAll(save=&#39;n&#39;,fmt=&#39;pdf&#39;,fignum=1,thetar=0) -&gt; plots phase tensor, strike angle, </span>
<span class="sd">     min and max phase angle, azimuth, skew, and ellipticity as subplots on one</span>
<span class="sd">     plot. </span>
<span class="sd">    </span>
<span class="sd">    You can save the plots by making save=&#39;y&#39; or a path you input. fmt is the</span>
<span class="sd">    fmt you want to save the figure as. Can be: pdf,eps,ps,png or svg. Fignum</span>
<span class="sd">    is the figure number in the event you want to plot multipl plots.&quot;&quot;&quot;</span>

    <span class="n">colorlst</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="s">&#39;g&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="s">&#39;m&#39;</span><span class="p">,</span><span class="s">&#39;y&#39;</span><span class="p">]</span>
    <span class="n">markerlst</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="s">&#39;o&#39;</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="s">&#39;h&#39;</span><span class="p">,</span><span class="s">&#39;v&#39;</span><span class="p">,</span><span class="s">&#39;^&#39;</span><span class="p">,</span><span class="s">&#39;&gt;&#39;</span><span class="p">,</span><span class="s">&#39;&lt;&#39;</span><span class="p">,</span><span class="s">&#39;p&#39;</span><span class="p">,</span><span class="s">&#39;*&#39;</span><span class="p">,</span><span class="s">&#39;x&#39;</span><span class="p">]</span>
    <span class="n">pcmlst</span><span class="o">=</span><span class="p">[(</span><span class="n">mm</span><span class="p">,</span><span class="n">cc</span><span class="p">)</span> <span class="k">for</span> <span class="n">mm</span> <span class="ow">in</span> <span class="n">markerlst</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">colorlst</span><span class="p">]</span>
        
    
<div class="viewcode-block" id="ptplots.__init__"><a class="viewcode-back" href="../../../imaging.ptplots.html#MTpy.imaging.ptplots.ptplots.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">impvar</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">impvar</span><span class="o">=</span><span class="n">impvar</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">impvar</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">impvar</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Z</span><span class="p">(</span><span class="n">fn</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">impvar</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="s">&#39;PTPlots&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="n">Z</span><span class="p">(</span><span class="n">impvar</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">impvar</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">impvar</span><span class="p">),</span><span class="s">&#39;PTPlots&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="s">&#39;PTPlots&#39;</span><span class="p">)</span>
        <span class="c">#make a list of colors and makers to use for plotting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mclst</span><span class="o">=</span><span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">ptplots</span><span class="o">.</span><span class="n">colorlst</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">mm</span> <span class="ow">in</span> <span class="n">ptplots</span><span class="o">.</span><span class="n">markerlst</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mclst</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">cc</span><span class="p">,</span><span class="n">mm</span><span class="p">])</span></div>
<div class="viewcode-block" id="ptplots.plotPhaseTensor"><a class="viewcode-back" href="../../../imaging.ptplots.html#MTpy.imaging.ptplots.ptplots.plotPhaseTensor">[docs]</a>    <span class="k">def</span> <span class="nf">plotPhaseTensor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">spacing</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">esize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">colorkey</span><span class="o">=</span><span class="s">&#39;beta&#39;</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">,</span>
                        <span class="n">fignum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">thetar</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plotPhaseTensor will plot phase tensor ellipses. Save=&#39;y&#39; if you </span>
<span class="sd">        want to save the figure with path similar to input file or Save=savepath</span>
<span class="sd">        if you want to define the path yourself.  fmt can be pdf,eps,ps,png,</span>
<span class="sd">        svg. &quot;&quot;&quot;</span>
        <span class="n">stationstr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">station</span>
        <span class="n">stationlst</span><span class="o">=</span><span class="p">[]</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;font.size&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">7</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.left&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mo">07</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.right&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">98</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.bottom&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">08</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.top&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">95</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.wspace&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">2</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.hspace&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">4</span>
          
        
        <span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)):</span>
            
            <span class="c">#get phase tensor elements </span>
            <span class="n">pt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">getPhaseTensor</span><span class="p">(</span><span class="n">thetar</span><span class="o">=</span><span class="n">thetar</span><span class="p">)</span>
            <span class="n">periodlst</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">period</span>
            <span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">periodlst</span><span class="p">)</span>
            <span class="n">station</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">station</span>
            <span class="n">stationlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">station</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dd</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">stationstr</span><span class="o">+=</span><span class="s">&#39;,&#39;</span><span class="o">+</span><span class="n">station</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
            
            <span class="c">#create a plot instance</span>
            <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fignum</span><span class="p">,[</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="s">&#39;equal&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="c">#make sure the ellipses will be visable</span>
                <span class="n">scaling</span><span class="o">=</span><span class="n">esize</span><span class="o">/</span><span class="n">pt</span><span class="o">.</span><span class="n">phimax</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
                <span class="n">eheight</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">phimin</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">scaling</span>
                <span class="n">ewidth</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">phimax</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">scaling</span>
                    
                <span class="c">#create an ellipse scaled by phimin and phimax and oriented along</span>
                <span class="c">#the azimuth    </span>
                <span class="n">ellip</span><span class="o">=</span><span class="n">Ellipse</span><span class="p">((</span><span class="n">spacing</span><span class="o">*</span><span class="n">ii</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">width</span><span class="o">=</span><span class="n">ewidth</span><span class="p">,</span>
                              <span class="n">height</span><span class="o">=</span><span class="n">eheight</span><span class="p">,</span>
                              <span class="n">angle</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">azimuth</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">ellip</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">pt</span><span class="o">.</span><span class="n">phimin</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">or</span> <span class="n">pt</span><span class="o">.</span><span class="n">phimin</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;nan&#39;</span><span class="p">:</span>
                    <span class="n">cvars</span><span class="o">=</span><span class="mi">0</span>
<span class="c">#                    print &#39;less than 0 or nan&#39;,cvars</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cvars</span><span class="o">=</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">phimin</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="c">#                    print &#39;calculated &#39;,cvars</span>
                    <span class="k">if</span> <span class="n">cvars</span><span class="o">&gt;</span><span class="mf">1.0</span><span class="p">:</span>
                        <span class="n">cvars</span><span class="o">=</span><span class="mi">0</span>
<span class="c">#                        print &#39;greater than 1 &#39;,cvars</span>
<span class="c">#                print cvars</span>
                    
                <span class="n">ellip</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">cvars</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">))</span>
            
        <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;</span><span class="si">%2.2g</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">periodlst</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">stop</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
                     <span class="n">step</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Period (s)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Phase Tensor Ellipses for &#39;</span><span class="o">+</span><span class="n">stationstr</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">stop</span><span class="o">=</span><span class="n">spacing</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">spacing</span><span class="p">),</span><span class="n">xticklabels</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">spacing</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span><span class="n">spacing</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">spacing</span><span class="p">,</span><span class="n">n</span><span class="o">*</span><span class="n">spacing</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">=</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">shrink</span><span class="o">=.</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">cb</span><span class="o">=</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="n">ptcmap</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">90</span><span class="p">))</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&#39;Min Phase&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stationlst</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">stationlst</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">markerscale</span><span class="o">=.</span><span class="mi">4</span><span class="p">,</span><span class="n">borderaxespad</span><span class="o">=.</span><span class="mo">05</span><span class="p">,</span>
                   <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span><span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">leg</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>
            <span class="n">ltext</span><span class="o">=</span><span class="n">leg</span><span class="o">.</span><span class="n">get_texts</span><span class="p">()</span>  <span class="c"># all the text.Text instance in the legend</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ltext</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>    <span class="c"># the legend text fontsize</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;y&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">)</span>
                <span class="k">print</span> <span class="s">&#39;Made Directory: &#39;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;PT.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span><span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;PT.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">save</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;PT.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span>
                        <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;PT.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;n&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        </div>
<div class="viewcode-block" id="ptplots.plotStrikeangle"><a class="viewcode-back" href="../../../imaging.ptplots.html#MTpy.imaging.ptplots.ptplots.plotStrikeangle">[docs]</a>    <span class="k">def</span> <span class="nf">plotStrikeangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">,</span><span class="n">fignum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">thetar</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the strike angle as calculated from the invariants. Save=&#39;y&#39; if you </span>
<span class="sd">        want to save the figure with path similar to input file or Save=savepath</span>
<span class="sd">        if you want to define the path yourself.  fmt can be pdf,eps,ps,png,</span>
<span class="sd">        svg. &quot;&quot;&quot;</span>
        
        <span class="n">stationstr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">station</span>
        <span class="n">stationlst</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">mlst</span><span class="o">=</span><span class="p">[]</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">medlst</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)):</span>
            <span class="n">mm</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">dd</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">zinv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">getInvariants</span><span class="p">(</span><span class="n">thetar</span><span class="o">=</span><span class="n">thetar</span><span class="p">)</span>
            <span class="n">period</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">period</span>
            <span class="n">medlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zinv</span><span class="o">.</span><span class="n">strike</span><span class="p">)</span>
            
            <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fignum</span><span class="p">,[</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">erxy</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">zinv</span><span class="o">.</span><span class="n">strike</span><span class="p">,</span>
                        <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mclst</span><span class="p">[</span><span class="n">mm</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                        <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mclst</span><span class="p">[</span><span class="n">mm</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                        <span class="n">yerr</span><span class="o">=</span><span class="n">zinv</span><span class="o">.</span><span class="n">strikeerr</span><span class="p">,</span><span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mclst</span><span class="p">[</span><span class="n">mm</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">mlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">erxy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">stationlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">station</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dd</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">stationstr</span><span class="o">+=</span><span class="s">&#39;,&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">station</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        
        <span class="k">if</span> <span class="n">medlst</span><span class="p">:</span>
            <span class="n">medlst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">medlst</span><span class="p">)</span>
            <span class="n">medp</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">medlst</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                          <span class="n">color</span><span class="o">=</span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="s">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">mlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">medp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">stationlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;Median&#39;</span><span class="p">)</span>
            <span class="n">meanp</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">medlst</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                          <span class="n">color</span><span class="o">=</span><span class="s">&#39;g&#39;</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="s">&#39;g&#39;</span><span class="p">)</span>
            <span class="n">mlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meanp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">stationlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;Mean&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;linear&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmax</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))),</span>
                 <span class="n">xmin</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">180</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">180</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stationlst</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">mlst</span><span class="p">),</span><span class="nb">tuple</span><span class="p">(</span><span class="n">stationlst</span><span class="p">),</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">markerscale</span><span class="o">=.</span><span class="mi">4</span><span class="p">,</span><span class="n">borderaxespad</span><span class="o">=.</span><span class="mo">05</span><span class="p">,</span>
                   <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span><span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">leg</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>
            <span class="n">ltext</span><span class="o">=</span><span class="n">leg</span><span class="o">.</span><span class="n">get_texts</span><span class="p">()</span>  <span class="c"># all the text.Text instance in the legend</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ltext</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>    <span class="c"># the legend text fontsize</span>
    
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Period (s)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Strike Angle (deg)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Strike Angle for &#39;</span><span class="o">+</span><span class="n">stationstr</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
      
        <span class="k">if</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;y&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">)</span>
                <span class="k">print</span> <span class="s">&#39;Made Directory: &#39;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Strike.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span><span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Strike.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">save</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Strike.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span>
                        <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Strike.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;n&#39;</span><span class="p">:</span>
            <span class="k">pass</span> 
        </div>
<div class="viewcode-block" id="ptplots.plotMinMaxPhase"><a class="viewcode-back" href="../../../imaging.ptplots.html#MTpy.imaging.ptplots.ptplots.plotMinMaxPhase">[docs]</a>    <span class="k">def</span> <span class="nf">plotMinMaxPhase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">,</span><span class="n">fignum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">thetar</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the minimum and maximum phase of phase tensor. Save=&#39;y&#39; if you </span>
<span class="sd">        want to save the figure with path similar to input file or Save=savepath</span>
<span class="sd">        if you want to define the path yourself.  fmt can be pdf,eps,ps,png,</span>
<span class="sd">        svg. &quot;&quot;&quot;</span>
        
        <span class="n">stationstr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">station</span>
        <span class="n">stationlst</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)):</span>
            <span class="n">pt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">getPhaseTensor</span><span class="p">(</span><span class="n">thetar</span><span class="o">=</span><span class="n">thetar</span><span class="p">)</span>
            <span class="n">period</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">period</span>
            <span class="n">minphi</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">phiminang</span>
            <span class="n">minphivar</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">phiminangvar</span>
            <span class="n">maxphi</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">phimaxang</span>
            <span class="n">maxphivar</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">phimaxangvar</span>
            
            <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fignum</span><span class="p">,[</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ermin</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">minphi</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                               <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mclst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                               <span class="n">yerr</span><span class="o">=</span><span class="n">minphivar</span><span class="p">,</span><span class="n">ecolor</span><span class="o">=</span><span class="s">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">ermax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">maxphi</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;o&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                               <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mclst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                               <span class="n">yerr</span><span class="o">=</span><span class="n">maxphivar</span><span class="p">,</span><span class="n">ecolor</span><span class="o">=</span><span class="s">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">stationlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">station</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dd</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">stationstr</span><span class="o">+=</span><span class="s">&#39;,&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">station</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
            
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;linear&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="n">ermin</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ermax</span><span class="p">[</span><span class="mi">0</span><span class="p">]),(</span><span class="s">&#39;Minimum&#39;</span><span class="p">,</span><span class="s">&#39;Maximum&#39;</span><span class="p">),</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;udder left&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmax</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))),</span>
                 <span class="n">xmin</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Period (s)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Phase (deg)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Min and Max Phase for &#39;</span><span class="o">+</span><span class="n">stationstr</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                  <span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;y&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">)</span>
                <span class="k">print</span> <span class="s">&#39;Made Directory: &#39;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;MMPhase.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span><span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;MMPhase.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">save</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;MMPhase.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span>
                        <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;MMPhase.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;n&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
    </div>
<div class="viewcode-block" id="ptplots.plotAzimuth"><a class="viewcode-back" href="../../../imaging.ptplots.html#MTpy.imaging.ptplots.ptplots.plotAzimuth">[docs]</a>    <span class="k">def</span> <span class="nf">plotAzimuth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">,</span><span class="n">fignum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">thetar</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plot the azimuth of maximum phase. Save=&#39;y&#39; if you </span>
<span class="sd">        want to save the figure with path similar to input file or Save=savepath</span>
<span class="sd">        if you want to define the path yourself.  fmt can be pdf,eps,ps,png,</span>
<span class="sd">        svg. &quot;&quot;&quot;</span>
        
        <span class="n">stationstr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">station</span>
        <span class="n">stationlst</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">mlst</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">medazm</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;font.size&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">7</span>
        <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fignum</span><span class="p">,[</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)):</span>
            
            <span class="n">pt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">getPhaseTensor</span><span class="p">(</span><span class="n">thetar</span><span class="o">=</span><span class="n">thetar</span><span class="p">)</span>
            <span class="c">#tipdict=self.z[dd].getTipper()</span>
            <span class="n">az</span><span class="o">=</span><span class="mi">90</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">azimuth</span><span class="p">)</span>
            <span class="n">azvar</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">azimuthvar</span><span class="p">)</span>
            <span class="n">medazm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
            <span class="c">#realarrow=tipdict[&#39;magreal&#39;]</span>
            <span class="c">#realarrowvar=np.zeros(len(realarrow))+.00000001</span>
            <span class="n">period</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">period</span>
            

            <span class="n">eraz</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">az</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mclst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">ms</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span>
                              <span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mclst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">mew</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span>
                              <span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">azvar</span><span class="p">,</span><span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mclst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="c">#            ertip=plt.errorbar(period,realarrow,marker=&#39;&gt;&#39;,ms=4,mfc=&#39;None&#39;,mec=&#39;k&#39;,</span>
<span class="c">#                               mew=1,ls=&#39;None&#39;,yerr=realarrowvar,ecolor=&#39;k&#39;)</span>
            <span class="n">mlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eraz</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">stationlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">station</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dd</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">stationstr</span><span class="o">=</span><span class="s">&#39;&#39;</span>
<span class="c">#                stationstr+=&#39;,&#39;+self.z[dd].station</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        
        <span class="k">if</span> <span class="n">medazm</span><span class="p">:</span>
            <span class="n">medazm</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">medazm</span><span class="p">)</span>
            <span class="n">medp</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">medazm</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span>
                          <span class="n">color</span><span class="o">=</span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="s">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">mlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">medp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">stationlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;Median&#39;</span><span class="p">)</span>
            <span class="n">meanp</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">medazm</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span>
                          <span class="n">color</span><span class="o">=</span><span class="s">&#39;g&#39;</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="s">&#39;g&#39;</span><span class="p">)</span>
            <span class="n">mlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meanp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">stationlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;Mean&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;linear&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stationlst</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">mlst</span><span class="p">),</span><span class="nb">tuple</span><span class="p">(</span><span class="n">stationlst</span><span class="p">),</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;lower left&#39;</span><span class="p">,</span>
                       <span class="n">markerscale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">borderaxespad</span><span class="o">=.</span><span class="mo">05</span><span class="p">,</span>
                       <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span><span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;size&#39;</span><span class="p">:</span><span class="mi">7</span><span class="p">},</span>
                       <span class="n">ncol</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">dd</span><span class="o">/</span><span class="mi">8</span><span class="p">)))</span>
<span class="c">#            leg=plt.gca().get_legend()</span>
<span class="c">#            ltext=leg.get_texts()  # all the text.Text instance in the legend</span>
<span class="c">#            plt.setp(ltext, fontsize=8)    # the legend text fontsize</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmax</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))),</span>
                 <span class="n">xmin</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">200</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Period (s)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Azimuth (deg. clockwise from N)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                   <span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Azimuth of Max Phase for &#39;</span><span class="o">+</span> \
                                <span class="n">stationstr</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;y&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">)</span>
                <span class="k">print</span> <span class="s">&#39;Made Directory: &#39;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Az.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span>
                        <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Az.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">save</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Az.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span>
                        <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Az.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;n&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        </div>
<div class="viewcode-block" id="ptplots.plotSkew"><a class="viewcode-back" href="../../../imaging.ptplots.html#MTpy.imaging.ptplots.ptplots.plotSkew">[docs]</a>    <span class="k">def</span> <span class="nf">plotSkew</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">,</span><span class="n">fignum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">thetar</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the skew angle. Save=&#39;y&#39; if you </span>
<span class="sd">        want to save the figure with path similar to input file or Save=savepath</span>
<span class="sd">        if you want to define the path yourself.  fmt can be pdf,eps,ps,png,</span>
<span class="sd">        svg. &quot;&quot;&quot;</span>
        
        <span class="n">stationstr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">station</span>
        <span class="n">stationlst</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">mlst</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)):</span>
        
            <span class="n">pt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">getPhaseTensor</span><span class="p">(</span><span class="n">thetar</span><span class="o">=</span><span class="n">thetar</span><span class="p">)</span>
            <span class="n">skew</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">beta</span>
            <span class="n">skewvar</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">betavar</span>
            <span class="n">period</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">period</span>
            
            <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fignum</span><span class="p">,[</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">erskew</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">skew</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mclst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                <span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mclst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                <span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">skewvar</span><span class="p">,</span><span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mclst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">mlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">erskew</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">stationlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">station</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dd</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">stationstr</span><span class="o">+=</span><span class="s">&#39;,&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">station</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
              
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;linear&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmax</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))),</span>
                 <span class="n">xmin</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">45</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stationlst</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">mlst</span><span class="p">),</span><span class="nb">tuple</span><span class="p">(</span><span class="n">stationlst</span><span class="p">),</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">markerscale</span><span class="o">=.</span><span class="mi">4</span><span class="p">,</span>
                       <span class="n">borderaxespad</span><span class="o">=.</span><span class="mo">05</span><span class="p">,</span><span class="n">labelspacing</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span><span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">leg</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>
            <span class="n">ltext</span><span class="o">=</span><span class="n">leg</span><span class="o">.</span><span class="n">get_texts</span><span class="p">()</span>  <span class="c"># all the text.Text instance in the legend</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ltext</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>    <span class="c"># the legend text fontsize</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Period (s)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Skew Angle (deg)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Skew Angle for &#39;</span><span class="o">+</span><span class="n">stationstr</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;y&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">)</span>
                <span class="k">print</span> <span class="s">&#39;Made Directory: &#39;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Skew.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span><span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Skew.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">save</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Skew.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span>
                        <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Skew.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;n&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        </div>
<div class="viewcode-block" id="ptplots.plotEllipticity"><a class="viewcode-back" href="../../../imaging.ptplots.html#MTpy.imaging.ptplots.ptplots.plotEllipticity">[docs]</a>    <span class="k">def</span> <span class="nf">plotEllipticity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">,</span><span class="n">fignum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">thetar</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the ellipticity as (phimax-phimin)/phimax+phimin). Save=&#39;y&#39; if you </span>
<span class="sd">        want to save the figure with path similar to input file or Save=savepath</span>
<span class="sd">        if you want to define the path yourself.  fmt can be pdf,eps,ps,png,</span>
<span class="sd">        svg. &quot;&quot;&quot;</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;font.size&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">8</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.left&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mo">07</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.right&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">98</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.bottom&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">08</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.top&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">95</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.wspace&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">2</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.hspace&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">4</span>
           
    
        <span class="n">stationstr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">station</span>
        <span class="n">stationlst</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">mlst</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)):</span>    
       
            <span class="n">period</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">period</span>
            <span class="n">pt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">getPhaseTensor</span><span class="p">(</span><span class="n">thetar</span><span class="o">=</span><span class="n">thetar</span><span class="p">)</span>
            <span class="n">ellipticity</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ellipticity</span>
            <span class="n">ellipticityvar</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ellipticityvar</span>
            
            <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fignum</span><span class="p">,[</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">erskew</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">ellipticity</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mclst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                                <span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mclst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                <span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">ellipticityvar</span><span class="p">,</span>
                                <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mclst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">stationlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">station</span><span class="p">)</span>
            <span class="n">mlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">erskew</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">dd</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">stationstr</span><span class="o">+=</span><span class="s">&#39;,&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">station</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;linear&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmax</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))),</span>
                 <span class="n">xmin</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c">#plt.yticks(range(10),np.arange(start=0,stop=1,step=.1))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stationlst</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">mlst</span><span class="p">),</span><span class="nb">tuple</span><span class="p">(</span><span class="n">stationlst</span><span class="p">),</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">markerscale</span><span class="o">=.</span><span class="mi">4</span><span class="p">,</span><span class="n">borderaxespad</span><span class="o">=.</span><span class="mo">05</span><span class="p">,</span>
                   <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span><span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">leg</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>
            <span class="n">ltext</span><span class="o">=</span><span class="n">leg</span><span class="o">.</span><span class="n">get_texts</span><span class="p">()</span>  <span class="c"># all the text.Text instance in the legend</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ltext</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>    <span class="c"># the legend text fontsize</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Period (s)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;$\mathbf{\phi_{max}-\phi_{min}/\phi_{max}+\phi_{min}}$&#39;</span><span class="p">,</span>
                   <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Ellipticity for &#39;</span><span class="o">+</span><span class="n">stationstr</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                  <span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;y&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">)</span>
                <span class="k">print</span> <span class="s">&#39;Made Directory: &#39;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Ellip.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span><span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Ellip.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">save</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Ellip.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span>
                        <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Ellip.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;n&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        </div>
<div class="viewcode-block" id="ptplots.plotAll"><a class="viewcode-back" href="../../../imaging.ptplots.html#MTpy.imaging.ptplots.ptplots.plotAll">[docs]</a>    <span class="k">def</span> <span class="nf">plotAll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xspacing</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">esize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">,</span>
                <span class="n">fignum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">thetar</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plotAll will plot phase tensor, strike angle, min and max phase angle, </span>
<span class="sd">        azimuth, skew, and ellipticity as subplots on one plot.  Save=&#39;y&#39; if you </span>
<span class="sd">        want to save the figure with path similar to input file or Save=savepath</span>
<span class="sd">        if you want to define the path yourself.  fmt can be pdf,eps,ps,png,</span>
<span class="sd">        svg. Fignum is the number of the figure.&quot;&quot;&quot;</span>
        
        <span class="n">stationstr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">station</span>
        <span class="n">stationlst</span><span class="o">=</span><span class="p">[]</span>
        <span class="c">#Set plot parameters</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;font.size&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">8</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.left&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mo">07</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.right&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">98</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.bottom&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">08</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.top&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">95</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.wspace&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">2</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.hspace&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">4</span>
        
        <span class="n">fs</span><span class="o">=</span><span class="mi">8</span>
        <span class="n">tfs</span><span class="o">=</span><span class="mi">10</span>
        <span class="c">#begin plotting</span>
        <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fignum</span><span class="p">,[</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)):</span>
            <span class="c">#get phase tensor infmtion</span>
            <span class="n">pt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">getPhaseTensor</span><span class="p">(</span><span class="n">thetar</span><span class="o">=</span><span class="n">thetar</span><span class="p">)</span>
            <span class="n">zinv</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">getInvariants</span><span class="p">(</span><span class="n">thetar</span><span class="o">=</span><span class="n">thetar</span><span class="p">)</span>
            <span class="n">tip</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">getTipper</span><span class="p">(</span><span class="n">thetar</span><span class="o">=</span><span class="n">thetar</span><span class="p">)</span>
            <span class="n">period</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">period</span>
            <span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>
            <span class="n">stationlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">station</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dd</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">stationstr</span><span class="o">+=</span><span class="s">&#39;,&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">dd</span><span class="p">]</span><span class="o">.</span><span class="n">station</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>

            
            <span class="c">#plotPhaseTensor</span>
            <span class="n">ax1</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="s">&#39;equal&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="c">#make sure the ellipses will be visable</span>
                <span class="n">scaling</span><span class="o">=</span><span class="n">esize</span><span class="o">/</span><span class="n">pt</span><span class="o">.</span><span class="n">phimax</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
                <span class="n">eheight</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">phimin</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">scaling</span>
                <span class="n">ewidth</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">phimax</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">scaling</span>
                    
                <span class="c">#create an ellipse scaled by phimin and phimax and oriented along</span>
                <span class="c">#the azimuth    </span>
                <span class="n">ellip</span><span class="o">=</span><span class="n">Ellipse</span><span class="p">((</span><span class="n">xspacing</span><span class="o">*</span><span class="n">ii</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">width</span><span class="o">=</span><span class="n">ewidth</span><span class="p">,</span>
                              <span class="n">height</span><span class="o">=</span><span class="n">eheight</span><span class="p">,</span>
                              <span class="n">angle</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">azimuth</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">ellip</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">pt</span><span class="o">.</span><span class="n">phimin</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">or</span> <span class="n">pt</span><span class="o">.</span><span class="n">phimin</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;nan&#39;</span><span class="p">:</span>
                    <span class="n">cvars</span><span class="o">=</span><span class="mi">0</span>
<span class="c">#                    print &#39;less than 0 or nan&#39;,cvars</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cvars</span><span class="o">=</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">phimin</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="c">#                    print &#39;calculated &#39;,cvars</span>
                    <span class="k">if</span> <span class="n">cvars</span><span class="o">&gt;</span><span class="mf">1.0</span><span class="p">:</span>
                        <span class="n">cvars</span><span class="o">=</span><span class="mi">0</span>
<span class="c">#                        print &#39;greater than 1 &#39;,cvars</span>
<span class="c">#                print cvars</span>
                    
                <span class="n">ellip</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">cvars</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">))</span>
            
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;</span><span class="si">%2.2g</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">period</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">stop</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
                         <span class="n">step</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Period (s)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
            <span class="c">#plt.title(&#39;Phase Tensor Ellipses for &#39;+stationstr,fontsize=14)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">stop</span><span class="o">=</span><span class="n">xspacing</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">xspacing</span><span class="p">),</span>
                       <span class="n">xticklabels</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">xspacing</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span><span class="n">xspacing</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">xspacing</span><span class="p">,</span><span class="n">n</span><span class="o">*</span><span class="n">xspacing</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">dd</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">ax1cb</span><span class="o">=</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">shrink</span><span class="o">=.</span><span class="mi">3</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s">&#39;horizontal&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=.</span><span class="mi">30</span><span class="p">)</span>
                <span class="n">cb</span><span class="o">=</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="n">ax1cb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="n">ptcmap</span><span class="p">,</span>
                                <span class="n">norm</span><span class="o">=</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">phiminang</span><span class="p">),</span>
                                               <span class="n">vmax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">phiminang</span><span class="p">)),</span>
                                <span class="n">orientation</span><span class="o">=</span><span class="s">&#39;horizontal&#39;</span><span class="p">)</span>
                <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s">&#39;Min Phase&#39;</span><span class="p">)</span>
        
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stationlst</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">stationlst</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">markerscale</span><span class="o">=.</span><span class="mi">4</span><span class="p">,</span><span class="n">borderaxespad</span><span class="o">=.</span><span class="mo">05</span><span class="p">,</span>
                       <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span><span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">leg</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>
                <span class="n">ltext</span><span class="o">=</span><span class="n">leg</span><span class="o">.</span><span class="n">get_texts</span><span class="p">()</span>  <span class="c"># all the text.Text instance in the legend</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ltext</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>    <span class="c"># the legend text fontsize</span>
        
            
            <span class="c">#plotStrikeAngle</span>
            
            <span class="n">az</span><span class="o">=</span><span class="mi">90</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">azimuth</span><span class="p">)</span>
            <span class="n">azvar</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">azimuthvar</span><span class="p">)</span>
            <span class="n">realarrow</span><span class="o">=</span><span class="n">tip</span><span class="o">.</span><span class="n">magreal</span>
            <span class="n">realarrowvar</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">realarrow</span><span class="p">))</span><span class="o">+.</span><span class="mo">00000001</span>
            
            <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">erxy</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">zinv</span><span class="o">.</span><span class="n">strike</span><span class="p">,</span>
                              <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                              <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                              <span class="n">yerr</span><span class="o">=</span><span class="n">zinv</span><span class="o">.</span><span class="n">strikeerr</span><span class="p">,</span>
                              <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">eraz</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">az</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                              <span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                              <span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">azvar</span><span class="p">,</span><span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="c">#ertip=plt.errorbar(period,realarrow,marker=&#39;&gt;&#39;,ms=4,mfc=&#39;None&#39;,mec=&#39;k&#39;,</span>
            <span class="c">#                   mew=1,ls=&#39;None&#39;,yerr=realarrowvar,ecolor=&#39;k&#39;)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="n">erxy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">eraz</span><span class="p">[</span><span class="mi">0</span><span class="p">]),(</span><span class="s">&#39;Strike&#39;</span><span class="p">,</span><span class="s">&#39;Azimuth&#39;</span><span class="p">),</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">markerscale</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span><span class="n">borderaxespad</span><span class="o">=.</span><span class="mo">01</span><span class="p">,</span><span class="n">labelspacing</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">leg</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>
            <span class="n">ltext</span>  <span class="o">=</span> <span class="n">leg</span><span class="o">.</span><span class="n">get_texts</span><span class="p">()</span>  <span class="c"># all the text.Text instance in the legend</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ltext</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>    <span class="c"># the legend text fontsize</span>
    
            
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;linear&#39;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmax</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))),</span>
                     <span class="n">xmin</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">200</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="c">#plt.xlabel(&#39;Period (s)&#39;,fontsize=fs,fontweight=&#39;bold&#39;)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Angle (deg)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Strike Angle, Azimuth&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">tfs</span><span class="p">,</span>
                      <span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
            
            <span class="c">#plotMinMaxPhase</span>
            
            <span class="n">minphi</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">phiminang</span>
            <span class="n">minphivar</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">phiminangvar</span>
            <span class="n">maxphi</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">phimaxang</span>
            <span class="n">maxphivar</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">phimaxangvar</span>
    
            <span class="n">ax3</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
            <span class="n">ermin</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">minphi</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                               <span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                               <span class="n">yerr</span><span class="o">=</span><span class="n">minphivar</span><span class="p">,</span><span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">ermax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">maxphi</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                               <span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                               <span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">maxphivar</span><span class="p">,</span>
                               <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;linear&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="n">ermin</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ermax</span><span class="p">[</span><span class="mi">0</span><span class="p">]),(</span><span class="s">&#39;$\phi_{min}$&#39;</span><span class="p">,</span><span class="s">&#39;$\phi_{max}$&#39;</span><span class="p">),</span>
                       <span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper left&#39;</span><span class="p">,</span><span class="n">markerscale</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span><span class="n">borderaxespad</span><span class="o">=.</span><span class="mo">01</span><span class="p">,</span>
                       <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span><span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">leg</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>
            <span class="n">ltext</span>  <span class="o">=</span> <span class="n">leg</span><span class="o">.</span><span class="n">get_texts</span><span class="p">()</span>  <span class="c"># all the text.Text instance in the legend</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ltext</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mf">6.5</span><span class="p">)</span>    <span class="c"># the legend text fontsize</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmax</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))),</span>
                     <span class="n">xmin</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="c">#plt.xlabel(&#39;Period (s)&#39;,fontsize=fs,fontweight=&#39;bold&#39;)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Phase (deg)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;$\mathbf{\phi_{min}}$ and $\mathbf{\phi_{max}}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">tfs</span><span class="p">,</span>
                      <span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>

            
            <span class="c">#plotSkew</span>
            
            <span class="n">skew</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">beta</span>
            <span class="n">skewvar</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">betavar</span>
    
            <span class="n">ax5</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
            <span class="n">erskew</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">skew</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                <span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                <span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">skewvar</span><span class="p">,</span>
                                <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">ax5</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">ax5</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;linear&#39;</span><span class="p">)</span>
            <span class="n">ax5</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmax</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))),</span><span class="n">xmin</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span>
                                <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">45</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Period (s)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Skew Angle (deg)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Skew Angle&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">tfs</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
            
            <span class="c">#plotEllipticity</span>
            
            <span class="n">ellipticity</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ellipticity</span>
            <span class="n">ellipticityvar</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">ellipticityvar</span>
    
            <span class="n">ax6</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
            <span class="n">erskew</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">ellipticity</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                <span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">ellipticityvar</span><span class="p">,</span>
                                <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pcmlst</span><span class="p">[</span><span class="n">dd</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">ax6</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">ax6</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;linear&#39;</span><span class="p">)</span>
            <span class="n">ax6</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmax</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))),</span>
                     <span class="n">xmin</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="c">#plt.yticks(range(10),np.arange(start=0,stop=1,step=.1))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Period (s)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;$\mathbf{\phi_{max}-\phi_{min}/\phi_{max}+\phi_{min}}$&#39;</span><span class="p">,</span>
                       <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Ellipticity&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">tfs</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
            <span class="c">#plt.suptitle(self.z.station,fontsize=tfs,fontweight=&#39;bold&#39;)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">&#39;Phase Tensor Elements for: &#39;</span><span class="o">+</span><span class="n">stationstr</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                     <span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;y&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">)</span>
                <span class="k">print</span> <span class="s">&#39;Made Directory: &#39;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;All.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span>
                        <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;All.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">save</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;All.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span>
                        <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;All.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;n&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
</div>
<div class="viewcode-block" id="ptplots.plotResPhase"><a class="viewcode-back" href="../../../imaging.ptplots.html#MTpy.imaging.ptplots.ptplots.plotResPhase">[docs]</a>    <span class="k">def</span> <span class="nf">plotResPhase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ffactor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="s">&#39;n&#39;</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">,</span><span class="n">fignum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">thetar</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plotResPhase(self,df=100.) will plot the resistivity and phase for</span>
<span class="sd">        all impedance tensor polarizations.  2 plots, one containing xy,yx </span>
<span class="sd">        polarizations, the other xx,yy.  Save=&#39;y&#39; if you want to save the figure</span>
<span class="sd">        with path similar to input file or Save=savepathif you want to define </span>
<span class="sd">        the path yourself.  fmt can be pdf,eps,ps,png, svg. Fignum is the </span>
<span class="sd">        number of the figure.&quot;&quot;&quot;</span>
        
        <span class="n">rp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getResPhase</span><span class="p">(</span><span class="n">ffactor</span><span class="o">=</span><span class="n">ffactor</span><span class="p">)</span>
        <span class="n">period</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">period</span>
        <span class="c">#set some plot parameters</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;font.size&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">10</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.left&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">13</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.right&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">98</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.bottom&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mo">07</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.top&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">96</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.wspace&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">25</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">&#39;figure.subplot.hspace&#39;</span><span class="p">]</span><span class="o">=.</span><span class="mi">20</span>
        
            
        <span class="c">#make figure for xy,yx components</span>
        <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fignum</span><span class="p">,[</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">erxy</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">rp</span><span class="o">.</span><span class="n">resxy</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                          <span class="n">mec</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">rp</span><span class="o">.</span><span class="n">resxyerr</span><span class="p">,</span>
                          <span class="n">ecolor</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">eryx</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">rp</span><span class="o">.</span><span class="n">resyx</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                          <span class="n">mec</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">rp</span><span class="o">.</span><span class="n">resyxerr</span><span class="p">,</span>
                          <span class="n">ecolor</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Period (s)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Addarent Resistivity ($\mathbf{\Omega \cdot m}$)&#39;</span><span class="p">,</span>
                   <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span>
                 <span class="n">xmax</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="n">erxy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">eryx</span><span class="p">[</span><span class="mi">0</span><span class="p">]),(</span><span class="s">&#39;$E_x/B_y$&#39;</span><span class="p">,</span><span class="s">&#39;$E_y/B_x$&#39;</span><span class="p">),</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">markerscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">borderaxespad</span><span class="o">=.</span><span class="mo">01</span><span class="p">,</span><span class="n">labelspacing</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">rp</span><span class="o">.</span><span class="n">phasexy</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                     <span class="n">mec</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">rp</span><span class="o">.</span><span class="n">phasexyerr</span><span class="p">,</span>
                     <span class="n">ecolor</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">rp</span><span class="o">.</span><span class="n">phaseyx</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                     <span class="n">mec</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">rp</span><span class="o">.</span><span class="n">phaseyxerr</span><span class="p">,</span>
                     <span class="n">ecolor</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Period (s)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Imepdance Phase (deg)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span>
                 <span class="n">xmax</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))))</span>
        <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">rp</span><span class="o">.</span><span class="n">phasexy</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">or</span> <span class="nb">min</span><span class="p">(</span><span class="n">rp</span><span class="o">.</span><span class="n">phaseyx</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">ymin</span><span class="o">=-</span><span class="mi">90</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;y&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">)</span>
                <span class="k">print</span> <span class="s">&#39;Made Directory: &#39;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Resxy.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span> <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Resxy.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">save</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Resxy.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span>
                        <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Resxy.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;n&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        
        <span class="c">#plot figure for xx,yy components</span>
        <span class="n">fig2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fignum</span><span class="o">+</span><span class="mi">1</span><span class="p">,[</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">erxy2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">rp</span><span class="o">.</span><span class="n">resxx</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                           <span class="n">mec</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">rp</span><span class="o">.</span><span class="n">resxxerr</span><span class="p">,</span>
                           <span class="n">ecolor</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">eryx2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">rp</span><span class="o">.</span><span class="n">resyy</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                           <span class="n">mec</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">rp</span><span class="o">.</span><span class="n">resyyerr</span><span class="p">,</span>
                           <span class="n">ecolor</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Period (s)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Addarent Resistivity ($\mathbf{\Omega \cdot m}$)&#39;</span><span class="p">,</span>
                   <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span>
                 <span class="n">xmax</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="n">erxy2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">eryx2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),(</span><span class="s">&#39;$E_x/B_x$&#39;</span><span class="p">,</span><span class="s">&#39;$E_y/B_y$&#39;</span><span class="p">),</span>
                    <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">markerscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">borderaxespad</span><span class="o">=.</span><span class="mo">01</span><span class="p">,</span><span class="n">labelspacing</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="n">ax3</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="n">ax3</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">rp</span><span class="o">.</span><span class="n">phasexx</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                     <span class="n">mec</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">rp</span><span class="o">.</span><span class="n">phasexxerr</span><span class="p">,</span>
                     <span class="n">ecolor</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">period</span><span class="p">,</span><span class="n">rp</span><span class="o">.</span><span class="n">phaseyy</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s">&#39;s&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span>
                     <span class="n">mec</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="n">mew</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">rp</span><span class="o">.</span><span class="n">phaseyyerr</span><span class="p">,</span>
                     <span class="n">ecolor</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Period (s)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Imepdance Phase (deg)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span>
                 <span class="n">xmax</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))))</span>
        <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">rp</span><span class="o">.</span><span class="n">phasexx</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">or</span> <span class="nb">min</span><span class="p">(</span><span class="n">rp</span><span class="o">.</span><span class="n">phaseyy</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">ymin</span><span class="o">=-</span><span class="mi">90</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;y&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">)</span>
                <span class="k">print</span> <span class="s">&#39;Made Directory: &#39;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">savepath</span>
            <span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Resxx.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span><span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savepath</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Resxx.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">save</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Resxx.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">),</span>
                        <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s">&#39;Resxx.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">save</span><span class="o">==</span><span class="s">&#39;n&#39;</span><span class="p">:</span>
            <span class="k">pass</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">MTpy 0.1 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Jared Peacock, Lars Krieger, Stephan Thiel, Kent Inverarity.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>